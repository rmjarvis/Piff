<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>v1.6 &mdash; Piff 1.6.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=72d88caf"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Revision History" href="history.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Piff
          </a>
              <div class="version">
                1.6
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">PIFF: PSFs In the Full FOV</a></li>
<li class="toctree-l1"><a class="reference internal" href="piffify.html">The piffify executable</a></li>
<li class="toctree-l1"><a class="reference internal" href="input.html">Reading in Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="select.html">Selecting Good PSF Stars</a></li>
<li class="toctree-l1"><a class="reference internal" href="model.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="interp.html">Interpolation Schemes</a></li>
<li class="toctree-l1"><a class="reference internal" href="psf.html">PSF classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="outliers.html">Removing Outliers</a></li>
<li class="toctree-l1"><a class="reference internal" href="output.html">Writing the output file</a></li>
<li class="toctree-l1"><a class="reference internal" href="stats.html">Output statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="star.html">Stars</a></li>
<li class="toctree-l1"><a class="reference internal" href="util.html">Utility Functions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="history.html">Revision History</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="history.html#changes-from-version-1-5-to-1-6">Changes from version 1.5 to 1.6</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="history.html#older-versions">Older Versions</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">v1.6</a></li>
<li class="toctree-l3"><a class="reference internal" href="#v1-5">v1.5</a></li>
<li class="toctree-l3"><a class="reference internal" href="#v1-4">v1.4</a></li>
<li class="toctree-l3"><a class="reference internal" href="#v1-3">v1.3</a></li>
<li class="toctree-l3"><a class="reference internal" href="#v1-2">v1.2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#v1-1">v1.1</a></li>
<li class="toctree-l3"><a class="reference internal" href="#v1-0">v1.0</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Piff</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="history.html">Revision History</a></li>
      <li class="breadcrumb-item active">v1.6</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/older.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p>Below is a summary of the major changes with each new tagged version of Piff.
Each version may also include various other minor changes and bug fixes not
listed here for brevity.  See the CHANGELOG files associates with each version
for a more complete list.  Issue numbers related to each change are given in parentheses.</p>
<section id="v1-6">
<h1>v1.6<a class="headerlink" href="#v1-6" title="Link to this heading"></a></h1>
<p><em>Performance improvements</em></p>
<ul class="simple">
<li><p>Made various performance improvements, courtesy of Nate Lust, from profiling how Piff is used
by the LSST DM stack. (#184)</p></li>
</ul>
<p><em>New features</em></p>
<ul class="simple">
<li><p>Allowed the weight and/or badpix images to be from different files than the main image.
(#147, #183)</p></li>
<li><p>Changed some of the logging messages to be at a more appropriate level.  (#132, #182)</p></li>
<li><p>Made it possible to exclude some cross terms in BasisPolynomial interpolation.  (#180)</p></li>
<li><p>Made fit_flux=True the default when using init=zero.  (#179)</p></li>
</ul>
<p><em>Bug fixes</em></p>
<ul class="simple">
<li><p>Added an appropriate logging message when the input images are too small to constrain a
PixelGrid model. (#131, #181)</p></li>
</ul>
</section>
<section id="v1-5">
<h1>v1.5<a class="headerlink" href="#v1-5" title="Link to this heading"></a></h1>
<p><em>Dependency Changes</em></p>
<ul class="simple">
<li><p>Added dependencies, Eigen and PyBind11.  (#173)</p></li>
<li><p>Added official support for python 3.13.</p></li>
<li><p>Stopped supporting a few old versions of dependencies. (#178)</p></li>
</ul>
<p><em>API Changes</em></p>
<ul class="simple">
<li><p>Changed the default behavior of the StarImages plot to include the average star and model. (#167)</p></li>
</ul>
<p><em>Performance improvements</em></p>
<ul class="simple">
<li><p>Added a JAX implementation of the BaisPolynomial math calculations. (#166)</p></li>
<li><p>Added a C++ Eigen implemenation of the BasisPolynomial math calculations.  (#173)</p></li>
</ul>
<p><em>New features</em></p>
<ul class="simple">
<li><p>Added an image of the average star and model in the StarImages output plot. (#167)</p></li>
<li><p>Added new Reader/Writer classes (#168, #170)</p></li>
<li><p>Added the ability to compute a weight image from a sky image. (#174)</p></li>
</ul>
<p><em>Bug fixes</em></p>
<ul class="simple">
<li><p>Fixed some places where the stats were not correctly using the new flagging interface. (#174)</p></li>
<li><p>Fixed a bug that could rarely cause a (nearly) infinite loop when recentering fails. (#178)</p></li>
</ul>
</section>
<section id="v1-4">
<h1>v1.4<a class="headerlink" href="#v1-4" title="Link to this heading"></a></h1>
<p><em>Output file changes</em></p>
<ul class="simple">
<li><p>Stars that were rejected as outliers are now included in the output file, but flagged. (#153)</p></li>
<li><p>Added an image of the average star and model in the StarImages output plot. (#167)</p></li>
</ul>
<p><em>API Changes</em></p>
<ul class="simple">
<li><p>Changed the list of property names to <code class="docutils literal notranslate"><span class="pre">psf.interp_property_names</span></code>. (#150)</p></li>
<li><p>Deprecated some redundant or potentially unclear type names. (#151)</p></li>
<li><p>Deprecated the include_reserve=True option for outlier rejection. (#153)</p></li>
<li><p>Deprecated copy_image=False option to psf.drawStar and psf.drawStarList. (#155)</p></li>
<li><p>Changed the default behavior of the StarImages plot to include the average star and model. (#167)</p></li>
</ul>
<p><em>Performance improvements</em></p>
<ul class="simple">
<li><p>Updated the DES-specific parameters for the <a class="reference internal" href="model.html#piff.Optical" title="piff.Optical"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Optical</span></code></a> PSF model to be more accurate. (#138)</p></li>
<li><p>Improved the flux/centroid-finding step of each iteration to be slightly more accurate. (#154)</p></li>
</ul>
<p><em>New features</em></p>
<ul class="simple">
<li><p>Added <code class="docutils literal notranslate"><span class="pre">mirror_figure</span></code> options for the <a class="reference internal" href="model.html#piff.Optical" title="piff.Optical"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Optical</span></code></a> PSF model. (#138)</p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">trust_pos</span></code> option in the input field.  This tells Piff not to adjust the star positions
when fitting the PSF. (#154)</p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">fit_flux</span></code> option for GSObject and PixelGrid models. (#155)</p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">init</span></code> option for all models. (#155)</p></li>
<li><p>Added <a class="reference internal" href="psf.html#piff.SumPSF" title="piff.SumPSF"><code class="xref any py py-class docutils literal notranslate"><span class="pre">SumPSF</span></code></a> PSF type. (#157)</p></li>
<li><p>Added <a class="reference internal" href="psf.html#piff.ConvolvePSF" title="piff.ConvolvePSF"><code class="xref any py py-class docutils literal notranslate"><span class="pre">ConvolvePSF</span></code></a> PSF type. (#162)</p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">dof</span></code> as a column in the stars section of the output file. (#165)</p></li>
<li><p>Added an option to show large T candidate stars in SizeMag plot.</p></li>
</ul>
<p><em>Bug fixes</em></p>
<ul class="simple">
<li><p>Fixed a number of minor errors and inefficiencies in the <a class="reference internal" href="model.html#piff.Optical" title="piff.Optical"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Optical</span></code></a> class. (#156)</p></li>
<li><p>Fixed a bug where reflux errors could cause the fit not to converge even though the
offending stars had already been flagged and removed from consideration.</p></li>
<li><p>Fixed an error in TwoDHist stats that T_model was incorrectly using the star data.</p></li>
<li><p>Fixed an error that caused the candidate stars not to display correctly in SizeMag plot.</p></li>
</ul>
</section>
<section id="v1-3">
<h1>v1.3<a class="headerlink" href="#v1-3" title="Link to this heading"></a></h1>
<p><em>Output file changes</em></p>
<ul class="simple">
<li><p>Preserve the dtype of property columns from input catalog to output file. (#141)</p></li>
<li><p>Changed the HSM file output column name from flag_truth to flag_data.  (#142)</p></li>
<li><p>Fixed type of reserve output column to be bool rather than float. (#143)</p></li>
<li><p>Automatically write any extra_properties from the input file into the output file. (#143)</p></li>
<li><p>Removed is_reserve column from the HSM output file.</p></li>
<li><p>Added piff_version to the FITS header in the HSM output file. (#148)</p></li>
</ul>
<p><em>API Changes</em></p>
<ul class="simple">
<li><p>Changed the name of the purity parameter of the SizeMag selector to impurity. (#146)</p></li>
</ul>
<p><em>Performance improvements</em></p>
<ul class="simple">
<li><p>Changed default interpolant for PixelGrid to Lanczos(7) rather than Lanczos(3). (#145)</p></li>
<li><p>Added guards against HSM failures when doing fourth_order/raw_moments in HSM output file. (#149)</p></li>
</ul>
<p><em>New features</em></p>
<ul class="simple">
<li><p>Added Wavefront class. (#134)</p></li>
<li><p>Made chipnum optional whenever the input model only covers a single chip. (#140)</p></li>
<li><p>Added option to output fourth_order moments in HSM output file. (#142)</p></li>
<li><p>Added option to output all raw moments in HSM output file. (#142)</p></li>
<li><p>Added star.withProperties method. (#143)</p></li>
<li><p>Added model_properties option for stats. (#143)</p></li>
<li><p>Added a <code class="docutils literal notranslate"><span class="pre">piff_version</span></code> attibute to PSF instances that are read from a file. (#146)</p></li>
</ul>
</section>
<section id="v1-2">
<h1>v1.2<a class="headerlink" href="#v1-2" title="Link to this heading"></a></h1>
<p><em>Output file changes</em></p>
<ul class="simple">
<li><p>Don’t skip stars in HSM output file.  Rather just flag failed HSM measurements.</p></li>
</ul>
<p><em>New features</em></p>
<ul class="simple">
<li><p>Added new select types: SizeMag, Properties, Flags, and SmallBright.</p></li>
<li><p>Flag objects when HSM returns a negative flux or moves the centroid by more than 1 pixel. (#136)</p></li>
<li><p>Use single_threaded context when doing multiprocessing.</p></li>
<li><p>Turn off TreeCorr’s multi-threading.</p></li>
</ul>
<p><em>Bug fixes</em></p>
<ul class="simple">
<li><p>Fixed bug in output stats that what we called T had actually been sigma. (#133, #142)</p></li>
<li><p>Fixed bug in making SizeMag stats plot when some flux values are negative. (#135)</p></li>
<li><p>Fixed labeling error in SizeMag plot (model and data were reversed). (#136)</p></li>
<li><p>Fixed bug in StarStat plot when nplot=0. (#136)</p></li>
<li><p>Fixed bug in SizeMag selector that the reserve and reject steps were applied twice. (#136)</p></li>
<li><p>Fix error that started in matplotlib v3.6.</p></li>
<li><p>Fix several deprecation warnings from recent matplotlib and scipy versions.</p></li>
</ul>
</section>
<section id="v1-1">
<h1>v1.1<a class="headerlink" href="#v1-1" title="Link to this heading"></a></h1>
<p><em>Dependency Changes</em></p>
<ul class="simple">
<li><p>Piff no longer supports Python 2.  We currently support Python 3.6 through 3.9.</p></li>
</ul>
<p><em>New features</em></p>
<ul class="simple">
<li><p>Added ability to interpolate on properties, given in the input file.</p></li>
</ul>
</section>
<section id="v1-0">
<h1>v1.0<a class="headerlink" href="#v1-0" title="Link to this heading"></a></h1>
<p>This is the first stable release.  It should have all the features desribed in the
Piff paper, Jarvis, et al, 2021.</p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="history.html" class="btn btn-neutral float-left" title="Revision History" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>